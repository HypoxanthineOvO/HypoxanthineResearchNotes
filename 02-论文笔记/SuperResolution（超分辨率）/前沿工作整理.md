# 1. Learning Texture Transformer Network for Image Super-Resolution

## 1. 该篇文章所研究的任务介绍
本文研究的任务是 **图像超分辨率（Image Super-Resolution, SR）**，旨在从低分辨率（Low-Resolution, LR）图像中恢复高分辨率（High-Resolution, HR）图像。SR 是计算机视觉领域的一个重要问题，广泛应用于医学成像、卫星图像处理和视频增强等领域。传统的单图像超分辨率（Single Image Super-Resolution, SISR）方法通常会产生模糊效果，因为 HR 纹理在退化过程中被过度破坏，难以恢复。近年来，基于参考的图像超分辨率（Reference-based Image Super-Resolution, RefSR）方法通过从参考图像中转移 HR 纹理，取得了显著进展。

## 2. 该篇文章的研究动机
**所遇到的现有方法的主要问题**：现有的 RefSR 方法通常采用直接的方式转移纹理，忽略了使用注意力机制来从参考图像中提取和转移 HR 纹理。这导致在复杂情况下（如大视角变化时），这些方法可能无法准确转移纹理，生成不满意的 SR 图像。例如，Zheng 等人提出的基于光流的方法在面对 LR 和 Ref 图像之间的大视角变化时，可能会搜索和转移不准确的纹理。Zhang 等人使用预训练分类模型的特征空间进行纹理搜索和转移，但这些高层语义特征无法有效表示 HR 纹理，导致生成的结果仍然不理想。

**我们提出的方法概述**：为了解决这些问题，本文提出了一种新颖的 **Texture Transformer Network for Image Super-Resolution (TTSR)**。TTSR 通过引入 transformer 架构，将 LR 和 Ref 图像分别表示为查询（query）和键（key），并设计了四个紧密相关的模块：可学习的纹理提取器（LTE）、相关性嵌入模块、硬注意力模块（HA）和软注意力模块（SA）。这些模块共同作用，实现了从 Ref 图像中准确转移 HR 纹理到 LR 图像，从而生成更逼真的 SR 图像。

## 3. 该篇文章所提出的主要方法
TTSR 的核心是 **纹理 transformer**，它由以下四个模块组成：
1. **可学习的纹理提取器（LTE）**：LTE 是一个深度神经网络，用于从 LR 和 Ref 图像中提取纹理特征。与使用预训练模型（如 VGG）不同，LTE 的参数在端到端训练中更新，能够更好地捕捉 LR 和 Ref 图像之间的联合特征。
2. **相关性嵌入模块**：该模块计算 LR 和 Ref 图像之间的相关性。具体来说，LR 和 Ref 图像的特征被表示为 transformer 中的查询（$Q$）和键（$K$），并通过归一化内积计算相关性 $r_{i,j}$：
   $$
   r_{i,j} = \left\langle \frac{q_i}{\|q_i\|}, \frac{k_j}{\|k_j\|} \right\rangle
   $$

3. **硬注意力模块（HA）**：HA 用于从 Ref 图像中转移 HR 纹理特征。它通过硬注意力图 $H$ 选择 Ref 图像中最相关的位置，并将这些位置的纹理特征转移到 LR 图像中。
4. **软注意力模块（SA）**：SA 用于合成从 Ref 图像转移的 HR 纹理特征和从 LR 图像提取的特征。它通过软注意力图 $S$ 增强相关纹理转移，同时减少不相关的纹理转移。
此外，TTSR 还引入了 **跨尺度特征集成模块（CSFI）**，通过堆叠多个纹理 transformer，在不同尺度（如 1 倍、2 倍和 4 倍）之间学习特征，从而进一步提升模型性能。
## 4. 该篇文章的实验效果
本文在多个公开数据集（如 CUFED 5、Sun 80、Urban 100 和 Manga 109）上进行了实验，评估了 TTSR 的性能。实验结果表明：
1. **定量评估**：TTSR 在 PSNR 和 SSIM 指标上显著优于现有最先进的 SISR 和 RefSR 方法。例如，在 CUFED 5 数据集上，TTSR 的 PSNR 达到了 27.09，SSIM 达到了 0.804，均优于其他方法。
2. **定性评估**：TTSR 生成的 SR 图像在视觉质量上表现出色，能够从参考图像中转移更准确的 HR 纹理，生成更逼真的结果。即使参考图像与输入图像在全局上不相关，TTSR 仍然可以从局部区域提取有效的纹理。
3. **用户研究**：通过用户研究，TTSR 在视觉质量上显著优于其他方法，超过 90% 的用户投票支持 TTSR。
4. **消融实验**：消融实验验证了 TTSR 中各个模块的有效性。例如，硬注意力模块（HA）和软注意力模块（SA）分别提升了 PSNR 0.25 和 0.22，而跨尺度特征集成模块（CSFI）进一步提升了 PSNR 0.17。
总结来说，TTSR 通过引入 transformer 架构和跨尺度特征集成，显著提升了图像超分辨率的性能，尤其是在纹理转移和视觉质量方面。
> [!notes] 这篇做的是 Reference-Based SR，感觉很难评价（？）